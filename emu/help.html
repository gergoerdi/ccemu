<!DOCTYPE html>
<html lang="en">

<title>JavaScript Compucolor II Emulator Help</title>

<head>
<link rel="stylesheet" type="text/css" href="ccemu.css" />
<style>
    body {
        background-color: #f4f4f4;
    }

    div#wrapper {
        margin: 6px;
        max-width:45em;
    }
    .key {
        font-family:monospace;
        line-height:1.5em;
        padding:1px 4px 1px 4px;
        border:1px solid black;
        background-color:#f4f4e0;
        border-radius:5px;
    }
</style>
</head>
<body>

<h1>Compucolor II Emulator Help</h1>

<div id="wrapper">

<p>
This is a collection of random notes that might make it easier to use the
emulator.  The Compucolor II had some funky features that have been faithfully
emulated, but made worse by the fact that the PC keyboard is missing many
of the dedicated keys that the Compucolor had (where is the "cyan" key?)
</p>

<ul>
    <li><a href="#important">The Most Important Things</a></li>
    <li><a href="#keyboard">Keyboard Mapping</a></li>
    <li><a href="#autotyping">Autotyping</a></li>
    <li><a href="#diskem">Disk Emulation</a></li>
    <li><a href="#virtual">Virtual Keyboard</a></li>
    <li><a href="#ROMs">ROM Versions</a></li>
    <li><a href="#charset">Character Set</a></li>
    <li><a href="#compatibility">Browser Compatibility</a></li>
    <li><a href="#random">Other Random Notes</a></li>
    <li><a href="#missing">Missing Fetures</a></li>
</ul>


<h2><a id="important">The Most Important Things</a></h2>

<p>
The Compucolor II, like most micros of that era, were very quirky machines,
and in this case, the keyboard was a standout in that regard.  There are a
few things to know in order to get much of anything done.
</p>

<p>
The Compucolor doesn't have lower case characters; instead, those codes map
to various graphics glyphs, such as chess pieces.  Since all BASIC commands
must use upper case, you have to hold
<span class="key">Shift</span>
to type letters, or more conveniently, just enable your
<span class="key">Caps Lock</span>
key.
</p>

<p>
Quickest way to kick the tires: use "Run a program" pulldown, although it
doesn't work in all browser versions.  See the later section on Autotyping.
</p>

<p>
The Compucolor has various modes of operation, and it can be confusing if
you find yourself stuck in one you didn't plan on.  The mode you care most
about is BASIC mode, and is the default mode when you start the machine.
For example, typing
<span class="key">Esc</span> <span class="key">D</span>
will put you in the FCS (file control system) mode.  In general, typing
<span class="key">Esc</span> <span class="key">E</span>
will put you back in BASIC while preserving whatever program was in memory,
and
<span class="key">Esc</span> <span class="key">W</span>
will get you back into BASIC mode while clearing out the program.  In the
worst case, hit the Hard Reset button or reload the page to get a fresh
start.
</p>

<p>
When entering text, left arrow and backspace both erase one character.
<span class="key">CTRL-K</span>
erases text to the start of the line.
<span class="key">CTRL-L</span>
erases the screen (page).
When a program is running, the down arrow interrupts.
When listing a program, the down arrow interrupts.
When listing a program, the
<span class="key">Break</span>
key will pause listing; type any other key to resume listing, except down
arrow which stops listing.  Hard Reset is like rebooting the machine --
everything is lost.  Warm Reset enters CRT mode.  Typing
<span class="key">Esc</span> <span class="key">E</span>
gets you back into BASIC with your program intact.
</p>

<h2><a id="keyboard">Keyboard Mapping</a></h2>

<p>
First off, the Compucolor doesn't support lower case letters.  To type
commands you either need to hold the SHIFT key down, or more conveniently,
activate the caps lock key.
</p>

<p><b>Repeat Key</b>:
The Compucolor didn't have typomatic keyboard action by default.  To get
autorepeating characters, you had to hold down the
<span class="key">REPEAT</span>
key while holding some other keyboard key to get a series of that key.
Obviously, modern PC keyboards don't have a
<span class="key">REPEAT</span>
key.  Instead, this emulator detects when the PC is autorepeating keys
and sends then pretends that the
<span class="key">REPEAT</span>
key is held down.  As a result, the repeat rate is that of the Compucolor,
not that of whatever your computer natively generates.
</p>

<p><b>Hard Reset</b>:
You can perform a hard reset on the CC-II either by pressing the dedicated
button on the webpage, or you can hit the key combination
<span class="key">Ctrl-Shift-CPU Reset</span>
on the <a href="#virtual">virtual keyboard</a>.
</p>

<p><b>Warm Reset</b>:
You can perform a warm reset on the CC-II either by pressing the dedicated
button on the webpage, or you can hit the
<span class="key">CPU Reset</span> key on the
<a href="#virtual">virtual keyboard</a>.
Either way, you will get a one line message, and the CC-II is waiting
for you to give a command.  The three that you will care about are
<ul>
    <li>The key sequence
        <span class="key">Esc</span> <span class="key">E</span>
        will bring you back to the BASIC command line without wiping out the
        program which was resident.
    </li>
    <li>The key sequence
        <span class="key">Esc</span> <span class="key">W</span>
        will reset the computer then give you the chance to enter the amount
        of RAM to use.
    </li>
    <li>The key sequence
        <span class="key">Esc</span> <span class="key">D</span>
        will drop you into the FCS prompt mode.  Hit the key sequence
        <span class="key">Esc</span> <span class="key">E</span>
        to get back to the BASIC prompt.
    </li>
</ul>

<p><b>Function keys</b>:
Most PC keyboards have
<span class="key">F1</span> through
<span class="key">F12</span>, while the CC-II had
<span class="key">F0</span>
through
<span class="key">F15</span>.  If you need those other buttons, use the
<a href="#virtual">virtual keyboard</a>
feature (below).  The low end CC-II keyboard didn't have any function keys,
so it shouldn't be critical.
</p>

<p><b>Numeric Keypad</b>:
Just make sure you have the
<span class="key">Num Lock</span>
key active, otherwise you'll get something other than numbers.
</p>

<p><b>Caps Lock</b>:
In general, Compucolor use required keeping the
<span class="key">Caps Lock</span>
key active nearly
all the time, as the machine didn't have lowercase letters.
The Compucolor uses the
<span class="key">Caps Lock</span>
key in one way: it inverts the meaning of the shift key for the characters
corresponding to 'A' to 'Z' and 'a' to 'z'.  If you press any of the letter
keys in combination with the
<span class="key">Ctrl</span>
key,
<span class="key">Caps Lock</span>
is ignored.
</p>

<p><b>Break</b>:
Pressing the
<span class="key">Break</span>
key while a program listing was scrolling by would pause the listing.
Hitting another key would resume listing.  The PC also has a
<span class="key">Break</span>
key, and is mapped to the same function. However, because this seldom used
key can be awkward to hit, the PC
<span class="key">End</span>
key has also been mapped to this function.
</p>

<h2><a id="autotyping">Autotyping</a></h2>

<p>
"Autotyping" is the name for reading a file from the host computer and
getting it into the emulated CC-II by having the emulator act as if
there is a very fast typist at the keyboard.  For arcane reasons, the
text which is entered by the autotyper isn't echoed to the screen,
although a carriage return is produced for each line.
</p>

<p>
The emulator comes with a list of programs you can run; use the pulldown
menu under "Run a program:" to choose one.  If you want to run your own
program, select "Use local file..." from the pulldown to navigate to
your own file.  This item might be missing if your browser doesn't support
the javascript FileReader API.
</p>

<p>
Because it takes a while for the BASIC interpreter to process each line,
it takes a few moments to transfer the whole file.  A progress bar is
displayed on top of the emulated CC-II screen, showing how much of the
file has been stuffed into the emulated CC-II.
If you change your mind during a file load, hitting the
<span class="key">Esc</span>
key will cancel the transfer.
</p>

<p>
There is one special feature to these autotyper files.
If the first line of a loaded text file begins with the exact
<pre>
[[[RESET]]]
</pre>
(no spaces) it will force the emulated Compucolor to go through a hard reset
before the rest of the file is read in.  This is convenient for autoloading
games so that it will make sure any program already in memory is wiped out.
Putting "RUN" as the last line of the file will make the program run as soon
as it is loaded.
</p>

<p><b>Warning:</b>
The CC-II uses the convention of using
<span class="key">Ctrl-M</span>
(hex 0D, carriage return)
line endings, the same convention that Macs use.  If the emulator detects
that you are trying to read in a file with the wrong line ending style
(either DOS or Unix), it will offer to map them (on the fly) to carriage
return style line endings.
</p>

<p><b>Warning:</b>
The input buffer in the BASIC interpreter uses has room for only 97 characters.
If you try to autotype a file containing lines which are longer than this, such
lines will get split up, and the result is likely to be a broken program.
</p>


<h2><a id="diskem">Disk Emulation</a></h2>

<p>
The emulator is configured with two virtual floppy disk drives,
CD0 and CD1.  Beneath the emulator window, use the pulldown to choose one
to insert into the corresponding drive.  If your browser supports the
FileReader API, you can also choose "Use local file..." to use a
compucolor virtual floppy (.ccvf) disk image of your choice.
</p>

<p>
After a floppy is loaded, the emulator attempts to read its volume label,
and if successful, that label is shown next to the drive indicator
(CD0: or CD1:).
</p>

<p>
Any time a given drive is selected, the drive indicator will turn red.
</p>

<p>
Most floppy disks, though not all, contain a "MENU.BAS" program.   For
such disks, the easiest way to get going is to insert the floppy, hit
the reset button (either hard reset or warm reset), then hit the Auto
button.  This will load and run MENU.BAS.
</p>

<p>
For advanced users, you can also enter FCS by typing
<span class="key">Esc</span>
<span class="key">D</span>
and issue any FCS command, such as DIR.  Please read the Compucolor user
manuals to learn how to use the floppy properly.
</p>

<p>
Finally, it should be noted that javascript, by design, doesn't allow
writing files onto your host computer file system.  If you want to save
a virtual disk image, the emulator has this hacky workaround.  Hold down the
<span class="key">Ctrl</span>
key then left click on the CD0: or CD1: label for the virtual disk image
you want to save.   This will pop open a window with the virtual disk image
in a text format.  Using that window's menu, save the file to disk.  Be
sure to save it as a .txt file, not an html file, otherwise it won't work.
If that doesn't work, use CTRL-A to select all the text in the window,
CTRL-C to copy it, then save it to a file yourself after pasting it into
a text editor.
</p>


<h2><a id="virtual">Virtual keyboard</a></h2>

<p>
The Compucolor came configured with one of three keyboard models: standard,
extended, and deluxe.  These had some key that don't have a corresponding
key on a standard PC keyboard, so in case you really need to use one of
these keys, the emulator has a "virtual keyboard" feature.  By default it
is hidden, but selecting one of the radio buttons on the left, under
"Virtual Keyboard:" will enable pane with a deluxe keyboard key set,
either in small, medium, or large size (to suit your preference).
The layout isn't strictly the same as a real deluxe keyboard &emdash;
some key groups have been moved to reduce how much screen real estate
the entire virtual keyboard takes up.
</p>

<p>
Rather than trying to explain all of it, I advise reading some of the
Compucolor documentation.
</p>


<h2><a id="ROMs">Character Set</a></h2>

<p>
The Compucolor II didn't have lower case characters; instead, the slots
which normally contained "a" through "z" contained various graphics
characters, like the four card suits and chess pieces.  This wasn't a great
situation for word processing, so despite having only an 8x8 grid to work
with, 3rd parties released hardware mods to allow switching between the
standard character set when playing games, and one containing lower case
letters while doing word processing.
</p>

<p>
The pulldown labeled "Character set" allows making the same choice.
</p>

<h2><a id="ROMs">ROM Versions</a></h2>

<p>
The Compucolor II was originally released with ROMs containing BASIC
and FCS (the file control system) known as version 6.78.  A couple years
later they released a new ROM version, 8.79.  This caused a bit of upset,
as many assembly language programs made use of subroutines in the ROM,
and most of them were moved to a new location.
</p>

<p>
For the most part, unless you have a specific reason to, just stick with
the v6.78 ROMs.  v8.79 doesn't buy much but incompatibility.
</p>

<h2><a id="compatibility">Browser Compatibility</a></h2>

<p><b>Firefox 19:</b>
The emulator has primarily been developed and tested on recent builds of the
Firefox browser and is known to work well there.
</p>

<p><b>IE 10:</b>
The emulator has received light testing with this browser and mostly works.
</p>

<ul>
    <li>IE 10 doesn't support fullscreen mode</li>
</ul>

<p><b>IE 9:</b>
The emulator has received light testing with this browser and mostly works.
</p>

<ul>
    <li>IE9 doesn't support fullscreen mode</li>
</ul>

<p><b>IE 8 and earlier:</b>
Nope -- too much work, primarily because they don't support the HTML canvas
element, and because javascript is relatively slow on those browsers.
</p>

<p><b>Chrome v25.something:</b>
The emulator has received light testing on a recent build of the Chrome
browser.  It seems to mostly work, with these known shortcomings.
</p>

<ul>
    <li>When running the emulator locally, by default when you try to
        run one of the programs from the "Run a program:" pulldown, it
        will fail.  This happens because you don't want the browser to
        be able to autonomously grab files off your local disk for
        inspection.  Either use the "Read File" button and navigate to
        the sources/ subdirectory of where the emulator code resides,
        or you can invoke Chrome with the following command line flag
        to permit accessing local files:
        <tt>--allow-file-access-from-files</tt>
    <li>Some key combinations that are valid to enter on the Compucolor
        get intercepted by the browser for its own purposes, including
        <span class="key">Ctrl-N</span> (new window),
        <span class="key">Ctrl-T</span> (new tab), and
        <span class="key">Ctrl-W</span> (close window).
    </li>
</ul>

<p><b>Safari v5.1.8:</b>
The emulator has received light testing on this build of Safari on OSX.
Reportedly Safari 6.x has improved things in regard to the problems below.
</p>

<ul>
    <li>Safari 5.x doesn't support the FileReader API, so the "Read File"
        button is hidden</li>
    <li>At least in Safari 5.1, full screen mode isn't usable for the
        emulator because it blocks acceptance of all alphanumeric keys.
        Even though the screen size pulldown indicates fullscreen mode
        is available, it doesn't work.  Perhaps Safari 6.x changes that.</li>
</ul>

<p><b>Opera v12.14:</b>
Light testing shows that it mostly works, save these few problems:
</p>
<ul>
    <li>Opera doesn't support the fullscreen API</li>
    <li>Attempting to execute one of the programs from the pulldown menu
        will result in an error -- instead, using the "Read File" button,
        navigate to the "sources/" folder in the same directory where the
        emulator page lives and read it that way.</li>
</ul>


<h2><a id="random">Other Random Notes</a></h2>

<ul>
    <li>Once in fullscreen mode, the
        <span class="key">Esc</span>
        key is used to get back to the normal browser window.  If you need to
        type
        <span class="key">Esc</span>
        into the emulator in this mode, you can type
        <span class="key">CTRL-[</span>
        instead.  Chrome views CTRL-[ as ESC as well and cancels fullscreen
        mode.
    </li>
</ul>


<h2><a id="missing">Missing features</a></h2>

<ul>
    <li>The serial port isn't emulated.  I don't plan on doing so.
    </li>
    <li>The Soundware card was a popular add-on for making noises for
        games and such.  I'm considering adding the feature.
    </li>
</ul>


</div>
<body>

<!--
  vim:expandtab:sw=4
  -->
